(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{392:function(s,t,a){"use strict";a.r(t);var n=a(7),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"package-json-导出、导入和自引用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#package-json-导出、导入和自引用"}},[s._v("#")]),s._v(" "),t("code",[s._v("package.json")]),s._v(" 导出、导入和自引用")]),s._v(" "),t("h4",{attrs:{id:"package-json-导出、导入和自引用-package-json-exports-imports-and-self-referencing"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#package-json-导出、导入和自引用-package-json-exports-imports-and-self-referencing"}},[s._v("#")]),s._v(" "),t("code",[s._v("package.json")]),s._v(" 导出、导入和自引用（"),t("code",[s._v("package.json")]),s._v(" Exports, Imports, and Self-Referencing）")]),s._v(" "),t("br"),s._v(" "),t("p",[s._v("Node.js 支持在 "),t("strong",[s._v("package.json")]),s._v(" 中定义入口点的新字段 "),t("a",{attrs:{href:"https://nodejs.org/api/packages.html#packages_exports",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("“exports”")]),t("OutboundLink")],1),s._v("。这个字段比在 "),t("code",[s._v("package.json")]),s._v(" 中定义 "),t("code",[s._v("“main”")]),s._v(" 更强大，可以控制包的哪些部分向消费者暴露。")]),s._v(" "),t("ul",[t("li",[s._v("下面是一个 "),t("code",[s._v("package.json")]),s._v("，它支持 CommonJS 和 ESM 的单独入口点:")])]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// package.json")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my-package"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"exports"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"."')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// Entry-point for `import "my-package"` in ESM')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ESM 中 “import my-package” 的入口点")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"import"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./esm/index.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// Entry-point for `require("my-package") in CJS')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CJS 中 require(“my-package”) 的入口点")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"require"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./commonjs/index.cjs"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CJS fall-back for older versions of Node.js")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CJS 是 Node.js 的旧版本的回退")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"main"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./commonjs/index.cjs"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("p",[s._v("关于这个特性有很多内容，你可以在 "),t("a",{attrs:{href:"https://nodejs.org/api/packages.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Node.js 文档"),t("OutboundLink")],1),s._v(" 中了解更多。在这里我们将关注 TypeScript 是如何支持它的。")]),s._v(" "),t("p",[s._v("有了 TypeScript 最初的 Node 支持，它会查找一个 "),t("code",[s._v("“main”")]),s._v(" 字段，然后查找与该条目对应的声明文件。例如，如果 "),t("code",[s._v('"main"')]),s._v(" 指向 "),t("code",[s._v("./lib/index.js")]),s._v("， TypeScript 会查找一个名为 "),t("code",[s._v("./lib/index.d.ts")]),s._v(" 的文件。包作者可以通过指定一个叫做 "),t("code",[s._v("“types”")]),s._v(" 的单独字段来覆盖这一点（例如："),t("code",[s._v('"types": "./types/index.d.ts"')]),s._v("）。")]),s._v(" "),t("p",[s._v("新的支持类似于导入条件（"),t("a",{attrs:{href:"https://nodejs.org/api/packages.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("import conditions"),t("OutboundLink")],1),s._v("）。默认情况下，TypeScript 用导入条件覆盖了相同的规则 —— 如果你从 ES 模块中编写了一个 "),t("code",[s._v("import")]),s._v(" 字段，它会查找 "),t("code",[s._v("import")]),s._v(" 字段，而从 CommonJS 模块中，它会查找 "),t("code",[s._v("require")]),s._v(" 字段。如果找到了，它将查找一个 colocated 声明文件。如果需要为类型声明指向不同的位置，可以添加一个 "),t("code",[s._v("“types”")]),s._v(" 导入条件。")]),s._v(" "),t("div",{staticClass:"language-ts line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ts"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// package.json")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my-package"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"exports"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"."')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Entry-point for TypeScript resolution - must occur first!")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// TypeScript 解析的入口点——必须首先出现!")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"types"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./types/index.d.ts"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// Entry-point for `import "my-package"` in ESM')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ESM 中 “import my-package” 的入口点")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"import"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./esm/index.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// Entry-point for `require("my-package") in CJS')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CJS 中 require(“my-package”) 的入口点")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"require"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./commonjs/index.cjs"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CJS fall-back for older versions of Node.js")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CJS 是 Node.js 的旧版本的回退")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"main"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./commonjs/index.cjs"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Fall-back for older versions of TypeScript")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 对较老版本的 TypeScript 的回退")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"types"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./types/index.d.ts"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("p",[s._v("TypeScript 也以类似的方式支持 "),t("code",[s._v("package.json")]),s._v(" 的 "),t("a",{attrs:{href:"https://nodejs.org/api/packages.html#packages_imports",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("“imports”")]),t("OutboundLink")],1),s._v(" 字段(在相应的文件旁边查找声明文件)，并支持包自身的自引用（"),t("a",{attrs:{href:"https://nodejs.org/api/packages.html#packages_self_referencing_a_package_using_its_name",target:"_blank",rel:"noopener noreferrer"}},[s._v("packages self-referencing themselves"),t("OutboundLink")],1),s._v("）。这些特性通常不涉及，但得到了支持。")])])}),[],!1,null,null,null);t.default=e.exports}}]);